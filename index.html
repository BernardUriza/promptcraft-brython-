<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptCraft - Curso Interactivo de Prompt Engineering</title>
    <meta name="description" content="Aprende Prompt Engineering de forma interactiva con lecciones, puzzles de l贸gica y gamificaci贸n.">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'></text></svg>">

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['Monaco', 'Menlo', 'Consolas', 'monospace'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/custom.css">

    <!-- Brython -->
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3.12.0/brython_stdlib.js"></script>

    <style>
        /* Loading screen */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        #loading-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 antialiased" onload="brython({debug: 0, cache: false})">

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="text-center text-white">
            <div class="text-6xl mb-4"></div>
            <h1 class="text-2xl font-bold mb-4">PromptCraft</h1>
            <div class="loader mx-auto mb-4"></div>
            <p class="text-indigo-200">Cargando curso interactivo...</p>
        </div>
    </div>

    <!-- App Root -->
    <div id="app-root" class="min-h-screen">
        <!-- El contenido se renderiza por Brython -->
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Main Python Script -->
    <script type="text/python">
from browser import document, window, html, timer

print("Starting PromptCraft...")

def start_app():
    try:
        # Importar la aplicaci贸n
        from brython_modules.app import init_app

        # Inicializar la aplicaci贸n
        app = init_app()

        # Ocultar loading screen
        loading = document.getElementById("loading-screen")
        if loading:
            loading.classList.add("fade-out")
            timer.set_timeout(lambda: loading.remove(), 500)

        print("PromptCraft loaded successfully!")

    except Exception as e:
        print(f"Error loading modular app: {e}")
        import traceback
        traceback.print_exc()
        print("Loading fallback inline version...")
        load_fallback_app()

def load_fallback_app():
    """Versi贸n fallback si los m贸dulos no cargan"""
    from browser import document, html, window
    from browser.local_storage import storage
    import json

    # Ocultar loading
    loading = document.getElementById("loading-screen")
    if loading:
        loading.classList.add("fade-out")
        timer.set_timeout(lambda: loading.remove(), 500)

    app_root = document.getElementById("app-root")
    app_root.innerHTML = ""

    # Crear layout b谩sico
    layout = html.DIV(Class="min-h-screen")

    # Navbar
    navbar = html.NAV(Class="bg-white shadow-sm py-3 sticky top-0 z-50")
    nav_content = html.DIV(Class="container mx-auto px-4 flex items-center justify-between")

    logo = html.A(
        html.SPAN("", Class="text-2xl") +
        html.SPAN("PromptCraft", Class="ml-2 text-xl font-bold text-gray-800"),
        href="#home",
        Class="flex items-center"
    )
    nav_content <= logo

    nav_links = html.DIV(Class="flex items-center gap-4")
    for route, label in [('#home', 'Inicio'), ('#lessons', 'Lecciones'), ('#puzzles', 'Puzzles'), ('#profile', 'Perfil')]:
        nav_links <= html.A(label, href=route, Class="text-gray-600 hover:text-indigo-600 px-3 py-2")
    nav_content <= nav_links

    navbar <= nav_content
    layout <= navbar

    # Main content
    main = html.MAIN(Class="container mx-auto px-4 py-8", id="app")

    # Welcome content
    welcome = html.DIV(Class="text-center py-12")
    welcome <= html.H1(" Bienvenido a PromptCraft", Class="text-4xl font-bold text-gray-800 mb-4")
    welcome <= html.P("Aprende Prompt Engineering de forma interactiva", Class="text-xl text-gray-600 mb-8")

    # Cards
    cards = html.DIV(Class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto")

    card_data = [
        ("", "Lecciones", "Aprende las t茅cnicas fundamentales", "#lessons"),
        ("З", "Puzzles", "Pon a prueba tu conocimiento", "#puzzles"),
        ("", "Playground", "Experimenta libremente", "#playground"),
    ]

    for icon, title, desc, link in card_data:
        card = html.A(
            html.DIV(
                html.SPAN(icon, Class="text-4xl mb-4 block") +
                html.H3(title, Class="text-xl font-semibold text-gray-800 mb-2") +
                html.P(desc, Class="text-gray-600"),
                Class="p-6 text-center"
            ),
            href=link,
            Class="bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md hover:border-indigo-200 transition-all block"
        )
        cards <= card

    welcome <= cards
    main <= welcome
    layout <= main

    # Footer
    footer = html.FOOTER(
        html.P("PromptCraft - Curso Interactivo de Prompt Engineering", Class="text-center text-gray-500"),
        Class="bg-white border-t py-6 mt-12"
    )
    layout <= footer

    app_root <= layout

    print("Fallback app loaded!")

# Iniciar con peque帽o delay
timer.set_timeout(start_app, 100)
    </script>

    <!-- Fallback content for no-JS -->
    <noscript>
        <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-600 to-purple-600">
            <div class="text-center text-white p-8">
                <div class="text-6xl mb-4"></div>
                <h1 class="text-2xl font-bold mb-4">PromptCraft</h1>
                <p class="text-indigo-200">
                    Este curso interactivo requiere JavaScript habilitado.
                    <br>
                    Por favor, habilita JavaScript en tu navegador.
                </p>
            </div>
        </div>
    </noscript>

</body>
</html>
